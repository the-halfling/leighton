<!DOCTYPE html>

<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="utf-8"/>
  <title>Leighton Shop</title>
  <link rel="stylesheet" href="temp/styles/styles.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

</head>
<body>

<header>

  <div class="header-mobile">

    <div class="top-bar" >
      <div class="top-bar--menu">
        <a onclick="toggle_visibility('mobile-nav');" >
          <i class="fas fa-bars"></i>
        </a>
      </div>    
      <div class="top-bar--logo">
        <img  src="../app/assets/images/logo.png" alt="the leighton shop" width="100%">
      </div>
      <div class="top-bar--basket">
        <i class="fas fa-shopping-cart"></i>
      </div>
    </div>

    <div id="mobile-nav" class="mobile-nav" style="display: none;">

      <div class="mobile-nav__country">
        <img src="../app/assets/images/uk_flag.png" alt="the leighton shop">
        <i class="fas fa-caret-down"></i>
      </div>

      <a onclick="toggle_visibility('mobile-nav__block1');" class="mobile-nav__button closed" >
        <div class="nav-button">
          About Leighton
        </div>
      </a>

      <div id="mobile-nav__block1" style="display: none;">  
        <ul>
          <a href="https://www.leighton.com/work/"><li>Work</li></a>
          <li><a href="https://www.leighton.com/services/">Services</a></li>
          <li><a href="https://www.leighton.com/insights/">Insights</a></li>
          <li><a href="https://www.leighton.com/blog/">Blog</a></li>
          <li><a href="https://www.leighton.com/events/">Events</a></li>
          <li><a href="#"><strong>Shop</strong></a></li>
          <li><a href="https://www.leighton.com/get-in-touch/">Contact</a></li>
        </ul>
      </div>

      <a onclick="toggle_visibility('mobile-nav__block2');" class="mobile-nav__button closed" >
        <div class="nav-button">
          Leighton Shop
        </div>
      </a>

      <div id="mobile-nav__block2" style="display: none;">  
        <ul>
          <a href="#"><li>Shop Home</li></a>
          <a onclick="toggle_visibility('mobile-nav__sub-block1');" class="mobile-nav__button closed"><li>Male</li></a>
          <div id="mobile-nav__sub-block1" style="display: none;">
            <ul>
              <li>Test Sub Category</li>
            <ul>
          </div>
          <a href="#"><li>Female</li></a>
          <a href="#"><li>Kids</li></a>
          <a href="#"><li>Sale</li></a>
          <a href="#"><li>Coming Soon</li></a>
        </ul>
      </div>
      
    </div>

  </div>

  <div class="header-desktop">
    <div class="header-desktop--upper">
      <ul>
        <a href="https://www.leighton.com/work/"><li>Work</li></a>
        <a href="https://www.leighton.com/services/"><li>Services</li></a>
        <a href="https://www.leighton.com/insights/"><li>Insights</li></a>
        <a href="https://www.leighton.com/blog/"><li>Blog</li></a>
        <a href="https://www.leighton.com/events/"><li>Events</li></a>
        <a href="#"><li><strong>Shop</strong></li></a>
        <a href="https://www.leighton.com/get-in-touch/"><li>Contact</li></a>
      </ul>

    </div>

    <div class="header-desktop--mid">
      <div class="header-desktop--mid__container">
        <div class="header-desktop--mid__country">
          <img src="../app/assets/images/uk_flag.png" alt="the leighton shop">
          <i class="fas fa-caret-down"></i>
        </div>
      </div>

      <div class="header-desktop--mid__logo">
        <img src="../app/assets/images/logo.png" alt="the leighton shop">
      </div>

      <div class="header-desktop--mid__container">
        <div class="header-desktop--mid__basket">
          <span>
            <i class="fas fa-shopping-cart"></i> Your Basket (<span class="red">x</span>)
          </span>
        </div>
      </div>
    </div>
  
    <div class="header-desktop--lower">
          <ul>
          <a href="#"><li>Shop Home</li></a>
          <a onclick="toggle_visibility('mobile-nav__sub-block1');" class="mobile-nav__button closed"><li>Male <i class="fas fa-caret-down"></i></li></a>
          <div id="mobile-nav__sub-block1" style="display: none;">
            <ul>
              <li>Test Sub Category</li>
            <ul>
          </div>
          <a href="#"><li>Female</li></a>
          <a href="#"><li>Kids</li></a>
          <a href="#"><li>Sale</li></a>
          <a href="#"><li>Coming Soon</li></a>
        </ul>
    </div>

  </div>
</header>

<div class="product-container">
  <div class="featured"></div>
  <div class="products"></div>
</div>

<script id="template" type="text/template">
    <div class="product">
      <div class="product--header">{{ type }} Product</div>
      <div class="product--image"><img src="../app/assets/images/no-image.jpg" alt="no image"> </div>
      <div class="product--information">
        <div class="product--title">{{ name }}</div>
        <div class="product--wishlist"></div>
        <!--This is just a place holder we would house the prices here if they were on the API -->
        <div class="product--price">Â£55</div>
        <div class="product--brand">Brand: {{ brand }}</div>
        <select>
            <option value="" disabled selected>Select Size</option>
            {{ options }}
        </select>
        <div class="product--description">Description:<br> {{ description }}</div>
        <div class="product--code">Product ID: {{ productid }}</div>
        <button class="btn--buy">Add to basket</button>
        <button class="btn--save">Save for later</button>     
      </div>
    </div
</script>

<script>(() => { 
//set API details
const apiUrl = 'https://27gmrimn45.execute-api.eu-west-2.amazonaws.com/demos/leighton-demo-api?TableName=products';
const headers = new Headers({
  'x-api-key': 'zQo4PPqD862IwDIQRZub8gX4dqjA3aW2DDhI6UF4',
});

const featured = document.querySelector('.featured');
const products = document.querySelector('.products');
const template = document.getElementById('template').innerHTML;
const featuredID = '0m8hjmd721';


const addItem = (item) => {

  const isFeatured = item.productid === featuredID;
  
  //replace the placeholders tempalte
  let html = template.replace('{{ name }}', item.name);
  html = html.replace('{{ brand }}', item.brand);
  html = html.replace('{{ description }}', item.description);
  html = html.replace('{{ productid }}', item.productid);

//loop through all available sizes and create an array
  let options = [];
  ['small', 'medium', 'large'].forEach((size) => {
    if (item.size[size] > 0) {
        options.push(`<option value="${size}">${size} - ${item.size[size]} In Stock</option>`);
    }
  });

  html = html.replace('{{ options }}', options.join(''));
  if (isFeatured) {
    html = html.replace('{{ type }}', 'Featured');
    return featured.innerHTML += html;
  }

  html = html.replace('{{ type }}', '');
  return products.innerHTML += html;

};

fetch(apiUrl, { headers }) 
.then(r => r.json()) 
.then(data => data.Items.forEach(addItem)) 
.catch(error => console.log(error)) 

})(); 

// Script to hide/show menu and toggle class on mobile navigation
$('.mobile-nav__button').click(function() {
    $(this).toggleClass('closed');
    $(this).toggleClass('open');
});

    function toggle_visibility(id) {
       var e = document.getElementById(id);
       if(e.style.display == 'block')
          e.style.display = 'none';
       else
          e.style.display = 'block';
    }
</script>


<footer>
  <div class="footer">
    <div class="footer--copyright">&copy; 2019 the leighton shop</div>
  </div>
</footer>

</body>
</html>